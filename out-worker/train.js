"use strict";
var Main;
(function (Main) {
    function train(trainingSets) {
        trainingSets.forEach((trainingSet, i) => {
            postMessage({
                type: 'training',
                char: Main.chars[i],
                current: i + 1
            });
            Main.perceptrons[i].learn(shuffle(addOutput(trainingSet, 1)
                .concat(...trainingSets.filter((_, j) => j !== i).map(set => addOutput(set, 0)))));
        });
        postMessage({
            type: 'trainFinished'
        });
    }
    Main.train = train;
    function addOutput(buffers, output) {
        return buffers.map(buffer => [new Uint8ClampedArray(buffer), output]);
    }
    function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }
})(Main || (Main = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhaW4uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMtd29ya2VyL3RyYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFVLElBQUksQ0E4QmI7QUE5QkQsV0FBVSxJQUFJO0lBRVYsZUFBc0IsWUFBNkI7UUFDL0MsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2hDLFdBQVcsQ0FBQztnQkFDUixJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFLEtBQUEsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDZCxPQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUM7YUFDQSxDQUFDLENBQUM7WUFDcEIsS0FBQSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztpQkFDakQsTUFBTSxDQUFDLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksU0FBUyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNGLENBQUMsQ0FBQyxDQUFDO1FBQ0gsV0FBVyxDQUFDO1lBQ1IsSUFBSSxFQUFFLGVBQWU7U0FDUCxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQWJlLFVBQUssUUFhcEIsQ0FBQTtJQUVELG1CQUFtQixPQUFzQixFQUFFLE1BQWE7UUFDcEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxJQUNyQixDQUFDLElBQUksaUJBQWlCLENBQUMsTUFBTSxDQUFDLEVBQUUsTUFBTSxDQUErQixDQUFDLENBQUM7SUFDL0UsQ0FBQztJQUVELGlCQUFvQixHQUFRO1FBQ3hCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUN0QyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLENBQUM7UUFDRCxNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQztBQUVMLENBQUMsRUE5QlMsSUFBSSxLQUFKLElBQUksUUE4QmIiLCJzb3VyY2VzQ29udGVudCI6WyJuYW1lc3BhY2UgTWFpbiB7XHJcblxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIHRyYWluKHRyYWluaW5nU2V0czogQXJyYXlCdWZmZXJbXVtdKSB7XHJcbiAgICAgICAgdHJhaW5pbmdTZXRzLmZvckVhY2goKHRyYWluaW5nU2V0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgIHBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICd0cmFpbmluZycsXHJcbiAgICAgICAgICAgICAgICBjaGFyOiBjaGFyc1tpXSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQ6IGkgKyAxXHJcbiAgICAgICAgICAgIH0gYXMgV29ya2VyTWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHBlcmNlcHRyb25zW2ldLmxlYXJuKHNodWZmbGUoYWRkT3V0cHV0KHRyYWluaW5nU2V0LCAxKVxyXG4gICAgICAgICAgICAgICAgLmNvbmNhdCguLi50cmFpbmluZ1NldHMuZmlsdGVyKChfLCBqKSA9PiBqICE9PSBpKS5tYXAoc2V0ID0+IGFkZE91dHB1dChzZXQsIDApKSkpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBwb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHR5cGU6ICd0cmFpbkZpbmlzaGVkJ1xyXG4gICAgICAgIH0gYXMgV29ya2VyTWVzc2FnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYWRkT3V0cHV0KGJ1ZmZlcnM6IEFycmF5QnVmZmVyW10sIG91dHB1dDogMCB8IDEpIHtcclxuICAgICAgICByZXR1cm4gYnVmZmVycy5tYXAoYnVmZmVyID0+XHJcbiAgICAgICAgICAgIFtuZXcgVWludDhDbGFtcGVkQXJyYXkoYnVmZmVyKSwgb3V0cHV0XSBhcyBbVWludDhDbGFtcGVkQXJyYXksIDAgfCAxXSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2h1ZmZsZTxUPihhcnI6IFRbXSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSBhcnIubGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkge1xyXG4gICAgICAgICAgICBjb25zdCBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XHJcbiAgICAgICAgICAgIFthcnJbaV0sIGFycltqXV0gPSBbYXJyW2pdLCBhcnJbaV1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=